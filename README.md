# ğŸ“˜ Dashboard Backend å®‰è£…ä¸æ¥å£è°ƒè¯•è¯´æ˜

æ›´æ–°æ—¶é—´ï¼š2025-05-26

---

## ğŸš€ å¿«é€Ÿå®‰è£…éƒ¨ç½²

### ç¯å¢ƒä¾èµ–

* Node.js 18+
* Docker (ç”¨äºè¿è¡Œ MongoDB)

### ä¸€é”®éƒ¨ç½²æ­¥éª¤

```bash
# è§£å‹é¡¹ç›®å‹ç¼©åŒ…
unzip dashboard-backend-with-install.zip
cd dashboard-backend

# å¯é€‰ï¼šèµ‹äºˆæ‰§è¡Œæƒé™
chmod +x install.sh

# æ‰§è¡Œå®‰è£…è„šæœ¬
./install.sh
```

è¯¥è„šæœ¬å°†è‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

* å®‰è£… Node ä¾èµ–ï¼ˆ`npm install`ï¼‰
* è‡ªåŠ¨å¤åˆ¶ `.env.example` ä¸º `.env`
* å¯åŠ¨æœ¬åœ° MongoDB å®¹å™¨ï¼ˆå¦‚æœªè¿è¡Œï¼‰
* å¯åŠ¨åç«¯æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ï¼š3001ï¼‰

---

## ğŸ”§ æ‰‹åŠ¨è¿è¡Œï¼ˆå¼€å‘æ¨¡å¼ï¼‰

```bash
# å¯åŠ¨ Mongo å®¹å™¨
MONGO_PORT=27017 docker run -d \
  --name dashboard-mongo \
  -p 27017:27017 \
  -v dashboard_mongo_data:/data/db \
  mongo:6

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æœåŠ¡
npm start
```

è®¿é—®æ¥å£ï¼š`http://localhost:3001`

---

## ğŸ” API Key æˆæƒè¯´æ˜

æ‰€æœ‰ API è¯·æ±‚éƒ½å¿…é¡»å¸¦ä¸Šåˆæ³•çš„ `API Key`ï¼Œæ”¯æŒä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€ï¼š

* è¯·æ±‚å¤´ï¼š`X-API-Key: your-api-key`
* URL å‚æ•°ï¼š`?key=your-api-key`

---
# ğŸ“˜ Dashboard åç«¯æ¥å£æ–‡æ¡£ï¼ˆæ¸…æ™°ç‰ˆï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„ä¸ç”¨é€”

```
dashboard-backend/
â”œâ”€â”€ controllers/              # è·¯ç”±æ§åˆ¶å™¨é€»è¾‘
â”‚   â”œâ”€â”€ apikey.controller.js      - åˆ›å»ºä¸æŸ¥è¯¢ API Key
â”‚   â”œâ”€â”€ config.controller.js      - è·å–ã€æ›´æ–°é…ç½®åŠèšåˆæ•°æ®
â”‚   â””â”€â”€ dashboard.controller.js   - å¤šä»ªè¡¨ç›˜çš„å¢åˆ æŸ¥æ”¹é€»è¾‘
â”‚
â”œâ”€â”€ routes/                  # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ apikey.routes.js        - `/api/apikey` è·¯ç”±ç»‘å®š
â”‚   â”œâ”€â”€ config.routes.js        - `/api/config` è·¯ç”±ç»‘å®š
â”‚   â””â”€â”€ dashboard.routes.js     - `/api/dashboard` è·¯ç”±ç»‘å®š
â”‚
â”œâ”€â”€ models/                  # å¯é€‰çš„ Mongo æ¨¡å‹å®šä¹‰
â”‚   â””â”€â”€ ApiKey.js               - API Key Schemaï¼ˆå¦‚ä½¿ç”¨ mongooseï¼‰
â”‚
â”œâ”€â”€ public/                  # é™æ€èµ„æºç›®å½•
â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡ï¼ˆæ•°æ®åº“ã€ç«¯å£ç­‰ï¼‰
â”œâ”€â”€ server.js                # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ package.json             # é¡¹ç›®ä¾èµ–ä¸å¯åŠ¨è„šæœ¬
â”œâ”€â”€ install.sh               # å®‰è£…ä¸åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ dashboard_mongo_init.json  # åˆå§‹åŒ–æ•°æ®åº“æ ·ä¾‹æ•°æ®
â”œâ”€â”€ README.md                # æœ¬æ¥å£æ–‡æ¡£
```


> æ›´æ–°æ—¶é—´ï¼š2025-05-26

---

## ğŸŒ åŸºç¡€ä¿¡æ¯

- æœåŠ¡åœ°å€ï¼ˆå¼€å‘ï¼‰ï¼š`http://localhost:3001`
- é‰´æƒæ–¹å¼ï¼š
  - è¯·æ±‚å¤´ï¼š`X-API-Key: your-key`
  - æˆ– URL å‚æ•°ï¼š`?key=your-key`

---

## ğŸ“‘ æ¥å£åˆ—è¡¨

| æ–¹æ³•  | è·¯å¾„                      | æè¿°                                | é‰´æƒ |
|-------|---------------------------|-------------------------------------|------|
| POST  | `/api/apikey`            | åˆ›å»º API Keyï¼ˆé€šè¿‡ userIdï¼‰         | å¦   |
| GET   | `/api/apikey`            | æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å·²æœ‰ API Key            | å¦   |
| GET   | `/api/config`            | è·å–é»˜è®¤ä»ªè¡¨ç›˜é…ç½®                  | æ˜¯   |
| PUT   | `/api/config`            | æ›´æ–°é»˜è®¤ä»ªè¡¨ç›˜é…ç½®                  | æ˜¯   |
| POST  | `/api/config/agg`        | æŸ¥è¯¢æŸä¸ªå¡ç‰‡çš„èšåˆæ•°æ®              | æ˜¯   |
| GET   | `/api/dashboard/list`    | è·å–ç”¨æˆ·æ‰€æœ‰ä»ªè¡¨ç›˜ç®€è¦ä¿¡æ¯åˆ—è¡¨      | æ˜¯   |
| GET   | `/api/dashboard/:id`     | è·å–æŸä¸ªä»ªè¡¨ç›˜è¯¦æƒ…ï¼ˆlayout ç­‰ï¼‰     | æ˜¯   |
| PUT   | `/api/dashboard/:id`     | ä¿®æ”¹æˆ–åˆ›å»ºæŸä¸ªä»ªè¡¨ç›˜                | æ˜¯   |
| DELETE| `/api/dashboard/:id`     | åˆ é™¤æŸä¸ªä»ªè¡¨ç›˜                      | æ˜¯   |

---

## ğŸ§© MongoDB é›†åˆç»“æ„

### apikeys é›†åˆ
```json
{
  "userId": "user_123",
  "key": "uuid-xxxx",
  "createdAt": "2025-05-26T10:00:00Z"
}
```
ğŸ“ å­˜å‚¨ç”¨æˆ·ç»‘å®šçš„å”¯ä¸€ API Keyã€‚

### device_stats é›†åˆ
```json
{
  "user": "user_001",
  "device": "AC",
  "energy": 1.85,
  "ts": "2025-05-25T08:00:00Z",
  "date": "2025-05-25"
}
```
ğŸ“ æ¯æ¡è®°å½•ä¸ºç”¨æˆ·æŸè®¾å¤‡æŸæ—¶æ®µçš„èƒ½è€—æ•°æ®ï¼Œä¾›èšåˆå¡ç‰‡æŸ¥è¯¢ä½¿ç”¨ã€‚

### dashboards é›†åˆ

### dashboards é›†åˆ
```json
{
  "userId": "user_001",
  "dashboardId": "default",
  "name": "èƒ½è€—æ¦‚è§ˆ",
  "icon": "https://cdn.site/icon/energy.png",
  "layout": {
    "cards": [
      {
        "title": "æ—¥ç”¨ç”µè¶‹åŠ¿",
        "type": "line",
        "collection": "device_stats",
        "pipeline": [...],
        "position": { "x": 0, "y": 1 },
        "size": { "w": 6, "h": 2 }
      }
    ]
  },
  "createdAt": "2025-05-26T10:00:00Z",
  "updatedAt": "2025-05-26T10:30:00Z"
}
```

---

## ğŸ“¥ æ¥å£ç¤ºä¾‹ä¸è¯´æ˜

### ğŸ” åˆ›å»º API Key

**POST** `/api/apikey`
```json
{
  "userId": "user_123"
}
```
è¿”å›ï¼š
```json
{ "key": "xxx-xxx-uuid" }
```

---

### ğŸ” æŸ¥è¯¢ API Key

**GET** `/api/apikey?userId=user_123`
è¿”å›ï¼ˆå­˜åœ¨ï¼‰ï¼š
```json
{ "key": "xxx-xxx-uuid" }
```
è¿”å›ï¼ˆæœªç»‘å®šï¼‰ï¼š
```json
{ "error": "API key not found for this user" }
```
ğŸ“ ä¸éœ€è¦é‰´æƒï¼Œå‰ç«¯å¯åˆ¤æ–­æ˜¯å¦å·²ç»‘å®šã€‚

---

### ğŸ“¥ è·å–ä»ªè¡¨ç›˜é…ç½®

**GET** `/api/config?key=xxx`
è¿”å›ï¼š
```json
{
  "userId": "user_123",
  "layout": {
    "cards": [ { "title": "...", ... } ]
  },
  "versions": [...]
}
```

---

### ğŸ“¤ æ›´æ–°ä»ªè¡¨ç›˜é…ç½®

**PUT** `/api/config?key=xxx`
```json
{
  "layout": {
    "cards": [
      {
        "title": "KPI ç¤ºä¾‹",
        "type": "kpi",
        "pipeline": [...],
        "position": { "x": 0, "y": 0 },
        "size": { "w": 2, "h": 1 }
      }
    ]
  }
}
```
è¿”å›ï¼š
```json
{ "ok": true, "config": { ...updated... } }
```

---

### ğŸ“Š èšåˆæŸ¥è¯¢å¡ç‰‡æ•°æ®

### ğŸ“ˆ ç¤ºä¾‹ï¼šå±•ç¤ºç”¨æˆ· user_001 ä¸‹ä¸‰å°ç©ºè°ƒçš„èƒ½è€—è¶‹åŠ¿

ğŸ“š **å­—æ®µå«ä¹‰è¯´æ˜ï¼ˆèšåˆå­—æ®µï¼‰**

| å­—æ®µ/æ“ä½œç¬¦     | è¯´æ˜                                                                 |
|------------------|----------------------------------------------------------------------|
| `$sum`           | èšåˆé˜¶æ®µä¸­ç”¨äºæ±‚å’Œï¼ˆå¦‚èƒ½è€—ã€æ•°é‡ç­‰ï¼‰ï¼Œ`"$sum": "$energy"` è¡¨ç¤ºå¯¹ energy å­—æ®µæ±‚å’Œ |
| `$device`        | è¿™æ˜¯ `$group` ä¸­å¯¹åŸå§‹æ–‡æ¡£ä¸­å­—æ®µ `device` çš„å¼•ç”¨ï¼Œå»ºè®®æ›¿æ¢ä¸º `did`ï¼ˆè®¾å¤‡ IDï¼‰å­—æ®µ |
| `$energy`        | è¡¨ç¤ºåŸå§‹æ–‡æ¡£ä¸­çš„èƒ½è€—å€¼å­—æ®µï¼Œå•ä½å¦‚ kWhï¼Œç”¨äº KPI æˆ–è¶‹åŠ¿è®¡ç®—                     |
| `_id`            | èšåˆåå”¯ä¸€é”®ï¼Œå¯ç»„åˆå¤šä¸ªå­—æ®µæ„æˆå¤åˆé”®ï¼Œå¦‚ `{ "device": "$device", "date": "$date" }` |
ğŸ§  ç±»ä¼¼æ“ä½œç¬¦è¿˜æœ‰ï¼š
| æ“ä½œç¬¦    | å«ä¹‰      |
| ------ | ------- |
| `$eq`  | ç­‰äº      |
| `$ne`  | ä¸ç­‰äº     |
| `$gt`  | å¤§äº      |
| `$lt`  | å°äº      |
| `$lte` | å°äºç­‰äº    |
| `$in`  | åœ¨æŒ‡å®šæ•°ç»„ä¸­  |
| `$nin` | ä¸åœ¨æŒ‡å®šæ•°ç»„ä¸­ |

ğŸ“Œ ç¤ºä¾‹è¯´æ˜ï¼šå±•ç¤º 3 å°ç©ºè°ƒè®¾å¤‡æ¯æ—¥èƒ½è€—çš„è¿è¡Œæ›²çº¿ï¼Œä½¿ç”¨è®¾å¤‡ IDï¼ˆå¦‚ `ac001`, `ac002`, `ac003`ï¼‰è¿›è¡ŒåŒºåˆ†ï¼Œä¸æ¨èä½¿ç”¨ä¸­æ–‡åç§°æˆ–åˆ«åå­—æ®µä½œä¸ºä¸»é”®ã€‚

âœ… æ•°æ®åº“ä¸­çš„ä¸€æ¡ç¤ºä¾‹è®°å½•åº”ä¸ºï¼š
```json
{
  "user": "user_001",
  "did": "ac001",              // è®¾å¤‡å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆDevice IDï¼‰
  "type": "AC",                 // å¯é€‰ï¼Œç”¨äºæ ‡è®°è®¾å¤‡ç±»å‹
  "energy": 1.72,
  "ts": "2025-05-25T08:00:00Z",
  "date": "2025-05-25"
}
```

ğŸ“Œ å»ºè®®ç»Ÿä¸€ä½¿ç”¨ `did` å­—æ®µä½œä¸ºè®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼Œåœ¨å¡ç‰‡ pipeline ä¸­æ”¹ä¸ºæŒ‰ `did` èšåˆã€‚


å‡è®¾ç”¨æˆ·æœ‰ä¸‰å°è®¾å¤‡ï¼š`AC_1`, `AC_2`, `AC_3`ï¼Œå¸Œæœ›åœ¨ä¸€å¼ æŠ˜çº¿å›¾ä¸­å±•ç¤ºå®ƒä»¬è¿‡å» 7 å¤©æ¯æ—¥æ€»èƒ½è€—å¯¹æ¯”ï¼š

å¡ç‰‡é…ç½®ï¼š
## ğŸ“¥ ç¤ºä¾‹ï¼šä¸‰å°ç©ºè°ƒæ¯æ—¥èƒ½è€—æ›²çº¿å¡ç‰‡ï¼ˆå¸¦å­—æ®µè¯´æ˜ï¼‰

```json
{
  "title": "ä¸‰å°ç©ºè°ƒæ¯æ—¥èƒ½è€—æ›²çº¿",           // å¡ç‰‡æ ‡é¢˜ï¼Œç”¨äºæ˜¾ç¤ºåœ¨ UI ä¸Šæ–¹
  "type": "line",                           // å›¾è¡¨ç±»å‹ï¼šæŠ˜çº¿å›¾
  "unit": "kWh",                            // å•ä½æ˜¾ç¤ºï¼Œå‰ç«¯å¯ç”¨äºæ ¼å¼åŒ–å€¼
  "collection": "device_stats",             // æ•°æ®æ¥æºé›†åˆå
  "pipeline": [                              // MongoDB èšåˆæŸ¥è¯¢é€»è¾‘
    { "$match": {                            // ç­›é€‰é˜¶æ®µï¼šç­›é€‰å‡ºç›®æ ‡ç”¨æˆ·ä¸è®¾å¤‡
      "user": "user_001",
      "device": { "$in": ["AC_1", "AC_2", "AC_3"] },  // `$in` è¡¨ç¤ºå­—æ®µå€¼åœ¨æ•°ç»„ä¸­
      "date": { "$gte": "2025-05-19" }                 // `$gte` è¡¨ç¤ºå¤§äºç­‰äºæŸæ—¥æœŸ
    }},
    { "$group": {                             // èšåˆé˜¶æ®µï¼šæŒ‰è®¾å¤‡ä¸æ—¥æœŸåˆ†ç»„æ±‚å’Œ
      "_id": { "device": "$device", "date": "$date" },
      "value": { "$sum": "$energy" }                // æ±‚å’Œå­—æ®µ `$sum` ä»£è¡¨ç»Ÿè®¡èƒ½è€—ä¹‹å’Œ
    }},
    { "$sort": { "_id.date": 1 } }           // æ’åºé˜¶æ®µï¼šæŒ‰æ—¥æœŸå‡åºæ’åˆ—ç»“æœ
  ],
  "position": { "x": 0, "y": 2 },           // å¡ç‰‡åœ¨ä»ªè¡¨ç›˜ä¸­çš„èµ·å§‹ä½ç½®ï¼ˆç½‘æ ¼åæ ‡ï¼‰
  "size": { "w": 6, "h": 2 },              // å¡ç‰‡å¤§å°ï¼ˆæ¨ªè·¨ 6 åˆ— 2 è¡Œï¼‰
  "color": "#2b7bba",                        // ä¸»è‰²è°ƒï¼Œå¯ç”¨äºå‰ç«¯ç»Ÿä¸€æ ·å¼
  "tooltip": "{device} {date}: {value} kWh"   // è‡ªå®šä¹‰é¼ æ ‡æ‚¬æµ®æç¤ºå†…å®¹æ¨¡æ¿
}
```

ğŸ“Œ å»ºè®®å°†å­—æ®µ `device` æ›¿æ¢ä¸º `did`ï¼ˆè®¾å¤‡ IDï¼‰ä»¥å¢å¼ºè®¾å¤‡å”¯ä¸€æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚

ğŸ“ å‰ç«¯å¯é€šè¿‡ `_id.device` å½’ç±»å¤šæ¡æŠ˜çº¿ï¼Œæ¨ªè½´å– `_id.date`ï¼Œçºµè½´å– `value` å±•ç¤ºã€‚
å‰ç«¯åº”ï¼š
- ä»¥ `_id.device` åˆ†ç»„ä¸ºæ¯æ¡æŠ˜çº¿
- ä»¥ `_id.date` æ˜¾ç¤ºæ¨ªè½´æ ‡ç­¾
- ä»¥ `value` ä½œä¸ºç‚¹å€¼æ˜¾ç¤ºèƒ½è€—

---

ğŸ“Œ å¡ç‰‡åº”åŒ…å«ä»¥ä¸‹ç»“æ„å­—æ®µä»¥è§„èŒƒå‰ç«¯æ¸²æŸ“è¡Œä¸ºï¼š
```json
{
  "title": "è®¾å¤‡è¶‹åŠ¿å¯¹æ¯”",
  "type": "line",                    // ç±»å‹ï¼škpi / line / bar / heatmap / html
  "unit": "kWh",                     // å•ä½ï¼Œå¦‚åŠŸè€—å•ä½ã€æ¬¡/å¤©ã€% ç­‰
  "color": "#00BFFF",                // å¯é€‰ï¼Œç”¨äºå¼ºè°ƒä¸»è‰²è°ƒï¼ˆæŠ˜çº¿é¢œè‰²ï¼‰
  "tooltip": "{device}: {value}kWh",  // å¯é€‰ï¼Œè‡ªå®šä¹‰æ‚¬æµ®æç¤ºæ ¼å¼
  "collection": "device_stats",       // æ•°æ®æ¥æºé›†åˆ
  "pipeline": [...],                  // èšåˆç®¡é“
  "position": { "x": 0, "y": 1 },     // å¸ƒå±€ä½ç½®
  "size": { "w": 6, "h": 2 }          // å¡ç‰‡å°ºå¯¸ï¼ˆæ …æ ¼å•ä½ï¼‰
}
```
ğŸ“ å»ºè®®åç«¯åªè´Ÿè´£å­˜å‚¨è¯¥ç»“æ„ï¼Œå‰ç«¯æ ¹æ® `type` ä¸å­—æ®µè‡ªåŠ¨è§£æå¹¶é€‚é…å›¾è¡¨é€»è¾‘ã€‚

ğŸ“ å¡ç‰‡çš„å–æ•°é€»è¾‘ç”± `collection` å’Œ `pipeline` å­—æ®µå®šä¹‰ï¼š
- `collection` è¡¨ç¤ºæŸ¥è¯¢çš„ MongoDB é›†åˆåï¼ˆå¦‚ `device_stats`ï¼‰
- `pipeline` æ˜¯æ ‡å‡† MongoDB èšåˆç®¡é“æ•°ç»„ï¼Œç»“æœç»“æ„ç”±å‰ç«¯æ¸²æŸ“é€»è¾‘é€‚é…

ğŸ“ å¦‚æœä½ å¸Œæœ›åœ¨ä¸€ä¸ªå¡ç‰‡ä¸­å±•ç¤ºå¤šä¸ªè®¾å¤‡è¿è¡Œæ›²çº¿æˆ–å¯¹æ¯”æ•°æ®ï¼Œè¯·çº¦å®šå¡ç‰‡ç»“æ„å¦‚ä¸‹ï¼š
```json
{
  "title": "å¤šè®¾å¤‡è¶‹åŠ¿å¯¹æ¯”",
  "type": "line",
  "collection": "device_stats",
  "pipeline": [
    { "$match": { "user": "user_001", "device": { "$in": ["AC", "Light", "Washer"] } } },
    { "$group": {
      "_id": { "device": "$device", "date": "$date" },
      "value": { "$sum": "$energy" }
    }},
    { "$sort": { "_id.date": 1 } }
  ]
}
```
ğŸ“ å‰ç«¯éœ€è§£æ `_id.device` ä¸ºæ¯æ¡çº¿çš„ keyï¼Œ`_id.date` ä¸ºæ¨ªè½´ï¼Œ`value` ä¸ºå€¼ã€‚


ğŸ“ å¦‚æœéœ€è¦åœ¨**ä¸€ä¸ªå¡ç‰‡ä¸­å±•ç¤ºå¤šä¸ªè®¾å¤‡çš„è¿è¡Œæ›²çº¿**ï¼ˆå¦‚æŠ˜çº¿å›¾ä¸­æ¯æ¡çº¿ä»£è¡¨ä¸€ä¸ªè®¾å¤‡ï¼‰ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹ pipeline æ¨¡å¼ï¼š

```json
{
  "collection": "device_stats",
  "pipeline": [
    { "$match": { "user": "user_001", "device": { "$in": ["AC", "Light", "Washer"] } } },
    { "$group": {
      "_id": { "device": "$device", "date": "$date" },
      "value": { "$sum": "$energy" }
    }},
    { "$sort": { "_id.date": 1 } }
  ]
}
```

ğŸ“ å‰ç«¯éœ€æ ¹æ® `_id.device` å°†ç»“æœå½’ç±»ä¸ºå¤šæ¡åºåˆ—ï¼šæ¯ä¸ªè®¾å¤‡ä¸€æ¡çº¿ã€‚



**POST** `/api/config/agg?key=xxx`
```json
{
  "collection": "device_stats",
  "pipeline": [
    { "$match": { "device": "AC" } },
    { "$group": { "_id": null, "total": { "$sum": "$energy" } } }
  ]
}
```
è¿”å›ï¼š
```json
{ "value": { "total": 285.7 } }
```

---

### ğŸ“‹ è·å–ä»ªè¡¨ç›˜åˆ—è¡¨

**GET** `/api/dashboard/list?key=xxx`
è¿”å›ï¼š
```json
[
  {
    "dashboardId": "default",
    "name": "èƒ½è€—æ¦‚è§ˆ",
    "icon": "https://cdn.site/icon1.png",
    "createdAt": "...",
    "updatedAt": "..."
  }
]
```

---

### ğŸ“„ è·å–ä»ªè¡¨ç›˜è¯¦æƒ…

**GET** `/api/dashboard/:id?key=xxx`
è¿”å›ï¼š
```json
{
  "dashboardId": "floor2",
  "layout": { "cards": [ ... ] },
  "name": "æ¥¼å±‚2åˆ†æ",
  "icon": "..."
}
```

---

### âœï¸ æ›´æ–°ä»ªè¡¨ç›˜

**PUT** `/api/dashboard/:id?key=xxx`
```json
{
  "name": "èƒ½è€—æ—¥æŠ¥",
  "icon": "https://cdn.site/newicon.png",
  "layout": { "cards": [ ... ] }
}
```
è¿”å›ï¼š
```json
{
  "dashboardId": "floor2",
  "updatedAt": "...",
  "layout": { "cards": [...] }
}
```

---

### âŒ åˆ é™¤ä»ªè¡¨ç›˜

**DELETE** `/api/dashboard/:id?key=xxx`
è¿”å›ï¼š
```json
{ "ok": true }
```
